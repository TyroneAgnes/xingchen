"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5346],{5346:(e,t,r)=>{r.d(t,{Pj:()=>I,Y$:()=>i,md:()=>l});var a=r(9827),n=r(709),s=r(9602);let o={NORMAL:{name:"普通代理",directCount:0,teamCount:0},WHITE_SHEEP:{name:"白羊座",directCount:0,teamCount:2},GOLDEN_BULL:{name:"金牛座",directCount:3,teamCount:3},GEMINI:{name:"巨蟹座",directCount:5,teamCount:10},CANCER:{name:"狮子座",directCount:6,teamCount:30},VIRGO:{name:"处女座",directCount:7,teamCount:100},LIBRA:{name:"天秤座",directCount:8,teamCount:300},SCORPIO:{name:"天蝎座",directCount:10,teamCount:1e3},SAGITTARIUS:{name:"射手座",directCount:12,teamCount:3e3},CAPRICORN:{name:"摩羯座",directCount:15,teamCount:1e4},AQUARIUS:{name:"水瓶座",directCount:20,teamCount:2e4},PISCES:{name:"双鱼座",directCount:30,teamCount:5e4},TEACHER:{name:"双子座(教皇)",directCount:40,teamCount:8e4}},i=e=>{let t=Object.values(o),r=t.findIndex(t=>t.name===e);if(-1===r||r===t.length-1)return null;let a=t[r+1];return{name:a.name,directNeeded:a.directCount,teamNeeded:a.teamCount}},l=e=>{let t=i(e.vipName);return t?{directNeeded:Math.max(0,t.directNeeded-e.directCount),teamNeeded:Math.max(0,t.teamNeeded-e.teamCount)}:null},u=e=>{let t=o.NORMAL;return(Object.values(o).forEach(r=>{e.directCount>=r.directCount&&e.teamCount>=r.teamCount&&r.directCount>=t.directCount&&r.teamCount>=t.teamCount&&(t=r)}),e.vipName!==t.name)?{...e,vipName:t.name,vipLevel:Object.values(o).findIndex(e=>e.name===t.name)+1}:e},m=(e,t)=>{let r=t.find(t=>t.id===e);if(!r)return 0;let a=0;return r.referees.forEach(e=>{a+=1,a+=m(e,t)}),a},c=e=>e.map(t=>({...t,teamCount:m(t.id,e)})),d=(e,t)=>[{time:"".concat(t," 09:30:00"),action:"buy",stockCode:"600519",stockName:"贵州茅台",price:1800,reason:"市场企稳，龙头股具有较强防御性"},{time:"".concat(t," 14:30:00"),action:"sell",stockCode:"600519",stockName:"贵州茅台",price:1830,reason:"获利了结，注意控制仓位"}],f={weekly:{reward:1e3,requirements:{inviteCount:1,minDeposit:5e3,timeLimit:7}},fiveStars:{reward:5e3,requirements:{inviteCount:5,minDeposit:5e3,timeLimit:0}},threeDay:{reward:1e3,requirements:{inviteCount:1,minDeposit:5e3,timeLimit:3}},sevenDay:{reward:5e3,requirements:{inviteCount:5,minDeposit:5e3,timeLimit:7}},fifteenDay:{reward:1e4,requirements:{inviteCount:15,minDeposit:5e3,timeLimit:15}},thirtyDay:{reward:2e4,requirements:{inviteCount:30,minDeposit:5e3,timeLimit:30}}},I=(0,a.v)()((0,n.Zr)((e,t)=>({userInfo:null,isLoading:!1,userBalance:0,starWalletBalance:0,starInvestBalance:0,totalAssets:0,marketList:[],tradeRecords:[],theme:"light",registeredUsers:[{id:"ADMIN",username:"admin",nickname:"管理员",password:"admin888",inviteCode:"XC888888",referees:[],token:"admin-token",balance:"200000",starWalletBalance:"200000",starInvestBalance:"200000",vipLevel:1,vipName:"普通代理",teamCount:0,directCount:0,teamProfit:"0",totalProfit:"0",yesterdayProfit:"0",starInvestProfit:"0",starWalletProfit:"0",avatar:"/avatars/admin.jpg",createTime:new Date().toISOString(),isFirstLogin:!0,commission:"0",teamPerformance:"0",completedTasks:[],currentTasks:[],taskHistory:[]}],rechargeRecords:[],setUserInfo:t=>e({userInfo:t}),setLoading:t=>e({isLoading:t}),logout:()=>{document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",e({userInfo:null,isLoading:!1,userBalance:0,starWalletBalance:0,starInvestBalance:0,marketList:[],tradeRecords:[],rechargeRecords:[]}),window.location.href="/login"},login:async(r,a)=>{let n=t(),s=n.registeredUsers.find(e=>e.username===r&&e.password===a);if(s){let t={...s,balance:s.balance||"200000",starWalletBalance:s.starWalletBalance||"200000",starInvestBalance:s.starInvestBalance||"200000"};return e({userInfo:t,registeredUsers:n.registeredUsers.map(e=>e.id===t.id?t:e),userBalance:parseFloat(t.balance),starWalletBalance:parseFloat(t.starWalletBalance),starInvestBalance:parseFloat(t.starInvestBalance),tradeRecords:n.tradeRecords||[]}),document.cookie="token=".concat(t.token,"; path=/; max-age=86400"),!0}return!1},register:async(r,a,n)=>{let s=t();if(s.registeredUsers.some(e=>e.username===r))return!1;let o=s.registeredUsers.find(e=>e.inviteCode.toUpperCase()===n.toUpperCase());if(!o)return!1;let i=s.generateUniqueId(),l={id:i,username:r,nickname:r,password:a,inviteCode:s.generateUniqueInviteCode(),referralCode:n,referrer:o.id,referees:[],token:Math.random().toString(36).substring(2),balance:"0",starWalletBalance:"0",starInvestBalance:"0",vipLevel:1,vipName:"普通代理",teamCount:0,directCount:0,teamProfit:"0",totalProfit:"0",yesterdayProfit:"0",starInvestProfit:"0",starWalletProfit:"0",avatar:"/avatars/default.png",createTime:new Date().toISOString(),isFirstLogin:!0,commission:"0",teamPerformance:"0",completedTasks:[],currentTasks:[],taskHistory:[]},u=c([...s.registeredUsers.map(e=>e.id===o.id?{...e,referees:[...e.referees,i],directCount:e.referees.length+1}:e),l]);return e({...t(),registeredUsers:u,userInfo:u.find(e=>e.id===l.id),userBalance:2e5,starWalletBalance:2e5,starInvestBalance:2e5}),!0},changePassword:async(r,a)=>{let n=t();if(!n.userInfo||n.userInfo.password!==r||a.length<8||a.length>20)return!1;let s={...n.userInfo,password:a};return e(e=>({userInfo:s,registeredUsers:e.registeredUsers.map(e=>e.id===s.id?s:e)})),!0},setUserBalance:t=>e({userBalance:t}),setStarWalletBalance:t=>e({starWalletBalance:t}),setStarInvestBalance:t=>e({starInvestBalance:t}),clearUserInfo:()=>e({userInfo:null}),marketList:[],setMarketList:t=>e({marketList:t}),updateMarketPrice:(t,r,a)=>e(e=>({marketList:e.marketList.map(e=>e.symbol===t?{...e,price:r,change:a}:e)})),tradeRecords:[],setTradeRecords:t=>e({tradeRecords:t}),addTradeRecord:t=>{let r=null;t.symbol.startsWith("星投-")?(r=(0,s.sJ)(t.total,t.mentorReturn||0),e(e=>({starInvestBalance:e.starInvestBalance+t.total,userInfo:e.userInfo?{...e.userInfo,starInvestBalance:(parseFloat(e.userInfo.starInvestBalance)+t.total).toFixed(2)}:null}))):t.symbol.startsWith("星钱包-")&&(r=(0,s.MN)(t.total));let a={...t,returnTime:null==r?void 0:r.returnTime.toISOString(),returnAmount:null==r?void 0:r.returnAmount};e(e=>({tradeRecords:[a,...e.tradeRecords]}))},calculateTotalAssets:()=>{let e=t();return e.userBalance+e.starWalletBalance+e.starInvestBalance},getYesterdayTotalProfit:()=>{let e=t();return e.userInfo?e.userInfo.yesterdayProfit:"0"},getStarInvestTotalProfit:()=>{let e=t();return e.userInfo?e.userInfo.starInvestProfit:"0"},getTodayStarWalletProfit:()=>{let e=t(),r=new Date().toISOString().split("T")[0];return e.tradeRecords.filter(e=>{if(!e.returnTime)return!1;let t=new Date(e.returnTime);return t.toISOString().split("T")[0]===r&&e.symbol.startsWith("星钱包-")&&10===t.getHours()}).reduce((e,t)=>e+(t.returnAmount||0),0).toFixed(2)},getDailyProfitCurve:()=>{let e=t(),r=new Map;return e.tradeRecords.filter(e=>e.returnAmount&&e.returnTime).forEach(e=>{let t=new Date(e.returnTime).toISOString().split("T")[0],a=r.get(t)||0;r.set(t,a+e.returnAmount)}),Array.from(r.entries()).map(e=>{let[t,r]=e;return{date:t,profit:r}}).sort((e,t)=>e.date.localeCompare(t.date))},processReturns:()=>{let r=t(),a=new Date,n=new Date(a);n.setDate(n.getDate()-1),r.tradeRecords.forEach(t=>{if("completed"===t.status&&t.returnTime&&t.returnAmount&&(0,s.en)(t.createTime,new Date(t.returnTime))){let r=new Date(t.returnTime),s=r.getDate()===n.getDate()&&r.getMonth()===n.getMonth()&&r.getFullYear()===n.getFullYear();e(e=>{let r=e.userInfo;if(!r)return e;let n=parseFloat(r.starInvestProfit),o=parseFloat(r.starWalletProfit),i=parseFloat(r.yesterdayProfit),l=e.userBalance,u=e.starWalletBalance,m=e.starInvestBalance;if(t.symbol.startsWith("星投-")){n+=t.returnAmount,l+=t.total+t.returnAmount,m-=t.total,s&&(i+=t.returnAmount);let c=t.mentorId?d(t.mentorId,t.createTime.split("T")[0]):[],f={id:"return-".concat(t.id),type:"sell",symbol:t.symbol.replace("买入","返还"),price:t.price,amount:t.amount,total:t.returnAmount,status:"completed",createTime:t.createTime,returnTime:a.toISOString(),mentorId:t.mentorId,mentorName:t.mentorName,mentorTrades:c};return{userBalance:l,starWalletBalance:u,starInvestBalance:m,userInfo:{...r,balance:l.toFixed(2),starWalletBalance:u.toFixed(2),starInvestBalance:m.toFixed(2),starInvestProfit:n.toFixed(2),starWalletProfit:o.toFixed(2),yesterdayProfit:i.toFixed(2),totalProfit:(n+o).toFixed(2)},tradeRecords:[f,...e.tradeRecords]}}return t.symbol.startsWith("星钱包-")&&(o+=t.returnAmount,l+=t.total+t.returnAmount,u-=t.total,s&&(i+=t.returnAmount)),{userBalance:l,starWalletBalance:u,starInvestBalance:m,userInfo:{...r,balance:l.toFixed(2),starWalletBalance:u.toFixed(2),starInvestBalance:m.toFixed(2),starInvestProfit:n.toFixed(2),starWalletProfit:o.toFixed(2),yesterdayProfit:i.toFixed(2),totalProfit:(n+o).toFixed(2)}}})}}),setInterval(()=>{let t=new Date;0===t.getHours()&&0===t.getMinutes()&&e(e=>({userInfo:e.userInfo?{...e.userInfo,yesterdayProfit:"0"}:null}))},6e4)},updateTeamProfit:t=>{e(e=>{let r=e.userInfo;if(!r)return e;let a=parseFloat(r.teamProfit);return{userInfo:{...r,teamProfit:(a+t).toFixed(2)}}})},toggleTheme:()=>e(e=>({theme:"light"===e.theme?"dark":"light"})),generateUniqueId:()=>{let e;let r=t();do e=Math.random().toString(36).substring(2,10).toUpperCase();while(r.registeredUsers.some(t=>t.id===e));return e},generateUniqueInviteCode:()=>{let e;let r=t();do e="XC"+Array.from({length:6},()=>Math.floor(10*Math.random())).join("");while(r.registeredUsers.some(t=>t.inviteCode.toUpperCase()===e.toUpperCase()));return e},checkLevelUpgrade:()=>{let r=t();if(!r.userInfo)return;let a=u(r.userInfo);a!==r.userInfo&&e({userInfo:a,registeredUsers:r.registeredUsers.map(e=>e.id===a.id?a:e)})},checkTaskEligibility:()=>{let r=t();if(!r.userInfo)return;let a=new Date,n=new Date(r.userInfo.createTime),s=Math.floor((a.getTime()-n.getTime())/864e5),o=e=>{let t=new Date;return t.setDate(t.getDate()-e),r.registeredUsers.filter(e=>{var a;return e.referrer===(null===(a=r.userInfo)||void 0===a?void 0:a.id)&&new Date(e.createTime)>t&&parseFloat(e.balance)>=5e3})},i=new Date(a);i.setDate(a.getDate()-a.getDay()),i.setHours(0,0,0,0);let l=r.registeredUsers.filter(e=>{var t;return e.referrer===(null===(t=r.userInfo)||void 0===t?void 0:t.id)&&new Date(e.createTime)>i&&parseFloat(e.balance)>=5e3}),u=r.registeredUsers.filter(e=>{var t;return e.referrer===(null===(t=r.userInfo)||void 0===t?void 0:t.id)&&parseFloat(e.balance)>=5e3});e(e=>{let t=e.userInfo;if(!t)return e;let r=[];return l.length>=1&&r.push({id:"weekly-".concat(Date.now()),type:"weekly",status:"completed",createTime:i.toISOString(),completeTime:a.toISOString(),reward:f.weekly.reward,requirements:f.weekly.requirements}),u.length>=5&&r.push({id:"fiveStars-".concat(Date.now()),type:"fiveStars",status:"completed",createTime:a.toISOString(),completeTime:a.toISOString(),reward:f.fiveStars.reward,requirements:f.fiveStars.requirements}),s<=30&&(s<=3&&o(3).length>=1&&r.push({id:"threeDay-".concat(Date.now()),type:"threeDay",status:"completed",createTime:t.createTime,completeTime:a.toISOString(),reward:f.threeDay.reward,requirements:f.threeDay.requirements}),s<=7&&o(7).length>=5&&r.push({id:"sevenDay-".concat(Date.now()),type:"sevenDay",status:"completed",createTime:t.createTime,completeTime:a.toISOString(),reward:f.sevenDay.reward,requirements:f.sevenDay.requirements}),s<=15&&o(15).length>=15&&r.push({id:"fifteenDay-".concat(Date.now()),type:"fifteenDay",status:"completed",createTime:t.createTime,completeTime:a.toISOString(),reward:f.fifteenDay.reward,requirements:f.fifteenDay.requirements}),s<=30&&o(30).length>=30&&r.push({id:"thirtyDay-".concat(Date.now()),type:"thirtyDay",status:"completed",createTime:t.createTime,completeTime:a.toISOString(),reward:f.thirtyDay.reward,requirements:f.thirtyDay.requirements})),{userInfo:{...t,currentTasks:r}}})},getTaskProgress:e=>{let r=t();if(!r.userInfo)return{completed:0,required:0,timeLeft:0};let a=new Date,n=new Date(r.userInfo.createTime),s=f[e],o=e=>{let t=new Date;return t.setDate(t.getDate()-e),r.registeredUsers.filter(e=>{var a;return e.referrer===(null===(a=r.userInfo)||void 0===a?void 0:a.id)&&new Date(e.createTime)>t&&parseFloat(e.balance)>=s.requirements.minDeposit}).length},i=0,l=0;switch(e){case"weekly":{let e=new Date(a);e.setDate(a.getDate()-a.getDay()),e.setHours(0,0,0,0),i=o(7),l=7-a.getDay();break}case"fiveStars":i=o(0),l=0;break;case"threeDay":i=o(3),l=Math.max(0,3-Math.floor((a.getTime()-n.getTime())/864e5));break;case"sevenDay":i=o(7),l=Math.max(0,7-Math.floor((a.getTime()-n.getTime())/864e5));break;case"fifteenDay":i=o(15),l=Math.max(0,15-Math.floor((a.getTime()-n.getTime())/864e5));break;case"thirtyDay":i=o(30),l=Math.max(0,30-Math.floor((a.getTime()-n.getTime())/864e5))}return{completed:i,required:s.requirements.inviteCount,timeLeft:l}},withdrawCommission:async r=>{let a=t();if(!a.userInfo)return!1;let n=parseFloat(a.userInfo.commission);return!(r>n)&&(e(e=>({userInfo:{...e.userInfo,commission:(n-r).toFixed(2),balance:(parseFloat(e.userInfo.balance)+r).toFixed(2)}})),!0)},submitWeeklyTask:async()=>{let r=t().getTaskProgress("weekly");if(r.completed<r.required)return!1;let a=f.weekly.reward;return e(e=>({userInfo:{...e.userInfo,commission:(parseFloat(e.userInfo.commission)+a).toFixed(2),teamPerformance:(parseFloat(e.userInfo.teamPerformance)+a).toFixed(2)}})),!0},submitFiveStarsTask:async()=>{let r=t().getTaskProgress("fiveStars");if(r.completed<r.required)return!1;let a=f.fiveStars.reward;return e(e=>({userInfo:{...e.userInfo,commission:(parseFloat(e.userInfo.commission)+a).toFixed(2),teamPerformance:(parseFloat(e.userInfo.teamPerformance)+a).toFixed(2),taskHistory:[...e.userInfo.taskHistory,{taskId:"fiveStars-".concat(Date.now()),type:"fiveStars",completeTime:new Date().toISOString(),reward:a}]}})),!0},submitThreeDayTask:async()=>{let r=t().getTaskProgress("threeDay");if(r.completed<r.required||r.timeLeft<=0)return!1;let a=f.threeDay.reward;return e(e=>({userInfo:{...e.userInfo,commission:(parseFloat(e.userInfo.commission)+a).toFixed(2),teamPerformance:(parseFloat(e.userInfo.teamPerformance)+a).toFixed(2),completedTasks:[...e.userInfo.completedTasks,{id:"threeDay-".concat(Date.now()),type:"threeDay",status:"completed",createTime:e.userInfo.createTime,completeTime:new Date().toISOString(),reward:a,requirements:f.threeDay.requirements}]}})),!0},submitSevenDayTask:async()=>{let r=t().getTaskProgress("sevenDay");if(r.completed<r.required||r.timeLeft<=0)return!1;let a=f.sevenDay.reward;return e(e=>({userInfo:{...e.userInfo,commission:(parseFloat(e.userInfo.commission)+a).toFixed(2),teamPerformance:(parseFloat(e.userInfo.teamPerformance)+a).toFixed(2),taskHistory:[...e.userInfo.taskHistory,{taskId:"sevenDay-".concat(Date.now()),type:"sevenDay",completeTime:new Date().toISOString(),reward:a}]}})),!0},submitFifteenDayTask:async()=>{let r=t().getTaskProgress("fifteenDay");if(r.completed<r.required||r.timeLeft<=0)return!1;let a=f.fifteenDay.reward;return e(e=>({userInfo:{...e.userInfo,commission:(parseFloat(e.userInfo.commission)+a).toFixed(2),teamPerformance:(parseFloat(e.userInfo.teamPerformance)+a).toFixed(2),completedTasks:[...e.userInfo.completedTasks,{id:"fifteenDay-".concat(Date.now()),type:"fifteenDay",status:"completed",createTime:e.userInfo.createTime,completeTime:new Date().toISOString(),reward:a,requirements:f.fifteenDay.requirements}]}})),!0},submitThirtyDayTask:async()=>{let r=t().getTaskProgress("thirtyDay");if(r.completed<r.required||r.timeLeft<=0)return!1;let a=f.thirtyDay.reward;return e(e=>({userInfo:{...e.userInfo,commission:(parseFloat(e.userInfo.commission)+a).toFixed(2),teamPerformance:(parseFloat(e.userInfo.teamPerformance)+a).toFixed(2),completedTasks:[...e.userInfo.completedTasks,{id:"thirtyDay-".concat(Date.now()),type:"thirtyDay",status:"completed",createTime:e.userInfo.createTime,completeTime:new Date().toISOString(),reward:a,requirements:f.thirtyDay.requirements}]}})),!0},rechargeRecords:[],submitRecharge:async(r,a)=>{let n=t();if(!n.userInfo)return!1;let s={id:Math.random().toString(36).substring(2),userId:n.userInfo.id,amount:r,imageUrl:a,status:"pending",createTime:new Date().toISOString()};return e(e=>({rechargeRecords:[...e.rechargeRecords,s]})),!0},approveRecharge:async r=>{let a=t().rechargeRecords.find(e=>e.id===r);return!!a&&"pending"===a.status&&(e(e=>{let t=e.userInfo;if(!t)return e;let n=parseFloat(t.balance)+a.amount;return{userInfo:{...t,balance:n.toFixed(2)},rechargeRecords:e.rechargeRecords.map(e=>e.id===r?{...e,status:"approved",approveTime:new Date().toISOString()}:e)}}),!0)},rejectRecharge:async(r,a)=>{let n=t().rechargeRecords.find(e=>e.id===r);return!!n&&"pending"===n.status&&(e(e=>({rechargeRecords:e.rechargeRecords.map(e=>e.id===r?{...e,status:"rejected",rejectReason:a}:e)})),!0)},getUserRechargeRecords:()=>{let e=t();return e.userInfo?e.rechargeRecords.filter(t=>{var r;return t.userId===(null===(r=e.userInfo)||void 0===r?void 0:r.id)}):[]}}),{name:"app-storage",partialize:e=>({theme:e.theme,registeredUsers:e.registeredUsers,userInfo:e.userInfo,userBalance:e.userBalance,starWalletBalance:e.starWalletBalance,starInvestBalance:e.starInvestBalance,tradeRecords:e.tradeRecords,rechargeRecords:e.rechargeRecords,totalAssets:e.calculateTotalAssets()}),version:6,migrate:e=>({...e,totalAssets:0,userInfo:e.userInfo||null,userBalance:e.userBalance||0,starWalletBalance:e.starWalletBalance||0,starInvestBalance:e.starInvestBalance||0,tradeRecords:e.tradeRecords||[],theme:e.theme||"light",registeredUsers:e.registeredUsers||[{id:"ADMIN",username:"admin",nickname:"管理员",password:"admin888",inviteCode:"XC888888",referees:[],token:"admin-token",balance:"200000",starWalletBalance:"200000",starInvestBalance:"200000",vipLevel:1,vipName:"普通代理",teamCount:0,directCount:0,teamProfit:"0",totalProfit:"0",yesterdayProfit:"0",starInvestProfit:"0",starWalletProfit:"0",avatar:"/avatars/admin.jpg",createTime:new Date().toISOString(),isFirstLogin:!0,commission:"0",teamPerformance:"0",completedTasks:[],currentTasks:[],taskHistory:[]}],rechargeRecords:e.rechargeRecords||[]})}))},9602:(e,t,r)=>{r.d(t,{MN:()=>i,cn:()=>s,en:()=>l,sJ:()=>o});var a=r(3463),n=r(9795);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,a.$)(t))}let o=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=new Date;return t.setHours(10,0,0,0),t.setDate(t.getDate()+1),{returnTime:t,returnAmount:e+.012*e}};function i(e){return{returnTime:function(e,t){let r=new Date,a=new Date(r);return a.setDate(r.getDate()+1),a.setHours(10,0,0,0),a}(0,0),returnAmount:e+.012*e}}function l(e,t){let r=new Date,a=new Date(e);return r>=t&&a<=t}}}]);